import{j as s}from"./jsx-runtime.TBa3i5EZ.js";import{r as p}from"./index.CVf8TyFT.js";const N=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#14b8a6","#f43f5e","#a855f7","#fb7185","#34d399","#fbbf24","#c084fc","#60a5fa","#f87171","#4ade80","#facc15","#a78bfa","#38bdf8","#fb923c","#ff6b9d","#22d3ee"];function K(){const[h,C]=p.useState([]),[M,R]=p.useState(!0),[g,u]=p.useState(new Set),[y,P]=p.useState([]),[z,w]=p.useState("random");p.useEffect(()=>{(async()=>{try{const o=await(await fetch("/season-2025-26/metadata.json")).json(),d=Object.keys(o.spieltage).map(Number).sort((i,f)=>i-f),j=[],k=new Map;for(const i of d){const f=await fetch(`/season-2025-26/spieltage/${String(i).padStart(2,"0")}.json`);if(!f.ok)continue;const v=await f.json();if(v.status==="not_started")continue;v.players.forEach(m=>{const S=k.get(m.name)||0;k.set(m.name,S+m.wurstliga_pts)}),Array.from(k.entries()).sort((m,S)=>S[1]-m[1]).forEach(([m,S],_)=>{j.push({spieltag:i,name:m,rank:_+1,points:S})})}const l=Array.from(new Set(j.map(i=>i.name)));P(l);const x=[...l].sort(()=>Math.random()-.5);u(new Set(x.slice(0,5))),C(j),R(!1)}catch(t){console.error("Error loading data:",t),R(!1)}})()},[]);const D=e=>{const t=new Set(g);t.has(e)?t.delete(e):t.add(e),u(t),w("none")},W=()=>{const e=[...y].sort(()=>Math.random()-.5);u(new Set(e.slice(0,5))),w("random")},E=()=>{u(new Set(y)),w("all")},I=()=>{u(new Set),w("none")},L=()=>{const e=h.filter(t=>{const o=Math.max(...h.map(d=>d.spieltag));return t.spieltag===o}).sort((t,o)=>t.rank-o.rank);u(new Set(e.slice(0,5).map(t=>t.name))),w("top5")},O=p.useMemo(()=>h.filter(e=>g.has(e.name)),[h,g]);if(M)return s.jsx("div",{className:"h-96 w-full flex items-center justify-center text-zinc-400",children:"Loading chart..."});if(h.length===0)return s.jsx("div",{className:"h-96 w-full flex items-center justify-center text-zinc-400",children:"No data available"});const a=Array.from(new Set(h.map(e=>e.spieltag))).sort((e,t)=>e-t),b=Math.max(...h.map(e=>e.rank)),A=700,$=400,n={top:20,right:20,bottom:40,left:40},r=A-n.left-n.right,c=$-n.top-n.bottom;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-zinc-800 rounded-lg p-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-3",children:[s.jsx("h3",{className:"text-sm font-medium text-zinc-200",children:"Spieler auswählen:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:W,className:`px-2 py-1 text-xs rounded transition-colors ${z==="random"?"bg-brand text-white":"bg-zinc-600 text-white hover:bg-zinc-500"}`,children:"Random"}),s.jsx("button",{onClick:L,className:`px-2 py-1 text-xs rounded transition-colors ${z==="top5"?"bg-brand text-white":"bg-zinc-600 text-white hover:bg-zinc-500"}`,children:"Top 5"}),s.jsx("button",{onClick:E,className:`px-2 py-1 text-xs rounded transition-colors ${z==="all"?"bg-brand text-white":"bg-zinc-600 text-white hover:bg-zinc-500"}`,children:"Alle"}),s.jsx("button",{onClick:I,className:`px-2 py-1 text-xs rounded transition-colors ${z==="none"?"bg-brand text-white":"bg-zinc-600 text-white hover:bg-zinc-500"}`,children:"Keine"})]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2",children:y.map((e,t)=>{const o=N[t%N.length],d=g.has(e);return s.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${d?"bg-zinc-700":"hover:bg-zinc-750"}`,children:[s.jsx("input",{type:"checkbox",checked:d,onChange:()=>D(e),className:"rounded"}),s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o}}),s.jsx("span",{className:"text-sm text-zinc-200 truncate",children:e})]},e)})}),s.jsxs("div",{className:"text-xs text-zinc-400 mt-2",children:[g.size," von ",y.length," Spielern ausgewählt"]})]}),s.jsx("div",{className:"bg-zinc-800 rounded-lg p-4 overflow-x-auto",children:g.size===0?s.jsx("div",{className:"h-96 flex items-center justify-center text-zinc-400",children:"Wähle Spieler aus, um deren Rangentwicklung zu sehen"}):s.jsxs("svg",{viewBox:`0 0 ${A} ${$}`,className:"w-full h-auto max-w-full bg-zinc-900 rounded",style:{minHeight:"300px",maxHeight:"500px"},children:[a.map(e=>{const t=a[a.length-1]-a[0],o=n.left+(t===0?r/2:(e-a[0])/t*r);return s.jsx("line",{x1:o,y1:n.top,x2:o,y2:n.top+c,stroke:"#374151",strokeWidth:.5,opacity:.5},`grid-${e}`)}),Array.from({length:b},(e,t)=>t+1).map(e=>{const t=n.top+(e-1)/(b-1)*c;return s.jsx("line",{x1:n.left,y1:t,x2:n.left+r,y2:t,stroke:"#374151",strokeWidth:.5,opacity:.5},`rank-${e}`)}),Array.from(g).map((e,t)=>{const o=O.filter(l=>l.name===e).sort((l,x)=>l.spieltag-x.spieltag),d=y.indexOf(e),j=N[d%N.length];if(o.length===0)return null;const k=o.map((l,x)=>{const i=a[a.length-1]-a[0],f=n.left+(i===0?r/2:(l.spieltag-a[0])/i*r),v=n.top+(l.rank-1)/(b-1)*c;return`${x===0?"M":"L"} ${f} ${v}`}).join(" ");return s.jsxs("g",{children:[s.jsx("path",{d:k,fill:"none",stroke:j,strokeWidth:2.5,className:"hover:stroke-4",style:{filter:"drop-shadow(0 0 2px rgba(0,0,0,0.3))"}}),o.map(l=>{const x=a[a.length-1]-a[0],i=n.left+(x===0?r/2:(l.spieltag-a[0])/x*r),f=n.top+(l.rank-1)/(b-1)*c;return s.jsxs("g",{children:[s.jsx("circle",{cx:i,cy:f,r:4,fill:j,stroke:"#1f2937",strokeWidth:1}),s.jsx("title",{children:`${e}: Rang ${l.rank} (${l.points} Pkt.) - Spieltag ${l.spieltag}`})]},`${e}-${l.spieltag}`)})]},e)}),s.jsx("line",{x1:n.left,y1:n.top+c,x2:n.left+r,y2:n.top+c,stroke:"#9ca3af",strokeWidth:2}),s.jsx("line",{x1:n.left,y1:n.top,x2:n.left,y2:n.top+c,stroke:"#9ca3af",strokeWidth:2}),a.map(e=>{const t=a[a.length-1]-a[0],o=n.left+(t===0?r/2:(e-a[0])/t*r);return s.jsx("text",{x:o,y:n.top+c+20,textAnchor:"middle",fill:"#9ca3af",fontSize:"12",children:e},`x-${e}`)}),Array.from({length:b},(e,t)=>t+1).map(e=>{const t=n.top+(e-1)/(b-1)*c;return s.jsx("text",{x:n.left-10,y:t+4,textAnchor:"end",fill:"#9ca3af",fontSize:"12",children:e},`y-${e}`)}),s.jsx("text",{x:n.left+r/2,y:$-5,textAnchor:"middle",fill:"#9ca3af",fontSize:"14",children:"Spieltag"}),s.jsx("text",{x:15,y:n.top+c/2,textAnchor:"middle",fill:"#9ca3af",fontSize:"14",transform:`rotate(-90 15 ${n.top+c/2})`,children:"Rang"})]})})]})}export{K as default};
